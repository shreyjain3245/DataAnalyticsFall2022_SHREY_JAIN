wd
# models
multi_reg <- lm(Schoolabsent_rate ~ Sugary_Drink + Fruit_Veg + Exercise + Obesity + Diabetes, data = new_district)
setwd("C:/Users/gwyne/Documents/GitHub/fall2022/data_analytics/assignments/assignment4")
library(ggplot2)
library(rpart)
library(rpart.plot)
nyc <- read.csv("NYC_Citywide_Annualized_Calendar_Sales_Update.csv")
# clean up data
nyc <- nyc[nyc$BOROUGH == "MANHATTAN" | nyc$BOROUGH == "1",]
nyc$GROSS.SQUARE.FEET <- gsub(",","",as.character(nyc$GROSS.SQUARE.FEET))
nyc$GROSS.SQUARE.FEET <- as.numeric(nyc$GROSS.SQUARE.FEET)
nyc$LAND.SQUARE.FEET <- gsub(",","",as.character(nyc$LAND.SQUARE.FEET))
nyc$LAND.SQUARE.FEET <- as.numeric(nyc$LAND.SQUARE.FEET)
nyc <- nyc[nyc$GROSS.SQUARE.FEET > 0 & !is.na(nyc$GROSS.SQUARE.FEET),]
nyc <- nyc[nyc$LAND.SQUARE.FEET > 0 & !is.na(nyc$LAND.SQUARE.FEET),]
nyc <- nyc[nyc$YEAR.BUILT > 0 & !is.na(nyc$YEAR.BUILT),]
nyc <- nyc[nyc$SALE.PRICE > 0 & !is.na(nyc$SALE.PRICE),]
# no scientific notation
options(scipen = 100)
# decision tree
dec <- data.frame(nyc$SALE.PRICE, nyc$GROSS.SQUARE.FEET)
colnames(dec) <- c("SalePrice", "GrossSquareFeet")
dec <- na.omit(dec)
sampl <- sample(150, 100)
train <- dec[sampl, ]
test <- dec[-sampl, ]
dim(train)
dim(test)
dtree <- rpart(SalePrice~., train, method="class")
dtree
rpart.plot(dtree, box.palette=0)
# rpart.plot(dtree, box.palette=0)
fancyRpartPlot(dtree,cex=5)
library(maptree)
draw.tree(fit,cex=5)
draw.tree(dtree,cex=5)
draw.tree(dtree,cex=3)
draw.tree(dtree,cex=1)
draw.tree(dtree,cex=0.5)
draw.tree(dtree,cex=1)
rpart.plot(dtree, box.palette=0)
dtree <- rpart(SalePrice~., train, method="class")
dtree
draw.tree(dtree,cex=1)
rpart.plot(dtree)
rpart.plot(dtree, cex=1)
rpart.plot(dtree, cex=0.5)
rpart.plot(dtree)
prp(model, faclen = 2)
prp(dtree, faclen = 2)
dtree
